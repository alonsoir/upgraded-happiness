{
  "agent_info": {
    "name": "geoip_enricher",
    "version": "2.0.0",
    "description": "Enriquecedor geogr√°fico para eventos de red",
    "mode": "distributed",
    "node_id": "geoip_enricher_001",
    "region": "eu-west-1",
    "datacenter": "dc-madrid"
  },
  "network": {
    "input": {
      "socket_type": "PULL",
      "connection_mode": "bind",
      "port": 5559,
      "bind_address": "*",
      "description": "Recibe eventos de promiscuous_agents",
      "high_water_mark": 1000,
      "timeout_ms": 5000
    },
    "output": {
      "mode": "distributed",
      "socket_type": "PUSH",
      "connection_mode": "connect",
      "targets": {
        "ml_detectors": [
          {
            "id": "ml_detector_001",
            "address": "localhost",
            "port": 5560,
            "weight": 100,
            "priority": 1,
            "enabled": true
          },
          {
            "id": "ml_detector_002",
            "address": "ml-detector-002.internal",
            "port": 5560,
            "weight": 100,
            "priority": 1,
            "enabled": false
          }
        ]
      },
      "load_balancing": {
        "strategy": "round_robin",
        "sticky_sessions": false,
        "failover_enabled": true,
        "retry_attempts": 3,
        "retry_delay_ms": 1000
      },
      "health_check": {
        "enabled": true,
        "interval_seconds": 30,
        "timeout_ms": 5000,
        "failure_threshold": 3
      },
      "connection_management": {
        "context_threads": 1,
        "high_water_mark": 1000,
        "linger_ms": 1000,
        "send_timeout_ms": 5000
      }
    },
    "backward_compatibility": {
      "local_mode": {
        "enabled": true,
        "output_socket_type": "PUSH",
        "output_connection_mode": "bind",
        "output_port": 5560,
        "bind_address": "*"
      }
    }
  },
  "geoip": {
    "provider": "maxmind",
    "database_path": "data/GeoLite2-City.mmdb",
    "enabled": true,
    "cache_enabled": true,
    "cache_size": 10000,
    "cache_ttl_seconds": 3600,
    "fallback_coordinates": {
      "latitude": 0.0,
      "longitude": 0.0,
      "country": "Unknown",
      "city": "Unknown"
    },
    "private_ip_handling": {
      "use_fallback": true,
      "custom_mapping": {
        "192.168.0.0/16": {"latitude": 40.4168, "longitude": -3.7038, "city": "Madrid", "country": "ES"},
        "10.0.0.0/8": {"latitude": 40.4168, "longitude": -3.7038, "city": "Madrid", "country": "ES"}
      }
    }
  },
  "processing": {
    "batch_processing": false,
    "batch_size": 10,
    "max_events_per_second": 1000,
    "stats_interval": 60,
    "enable_enrichment_validation": true,
    "preserve_original_fields": true
  },
  "performance": {
    "max_memory_mb": 512,
    "worker_threads": 1,
    "io_threads": 1,
    "prefetch_count": 100
  },
  "monitoring": {
    "metrics": {
      "enabled": false,
      "prometheus_port": 9091
    },
    "alerting": {
      "enabled": false,
      "thresholds": {
        "geoip_lookup_errors": 50,
        "processing_latency_ms": 100
      }
    }
  },
  "logging": {
    "level": "INFO",
    "file": "logs/geoip_enricher.log",
    "max_size": "10MB",
    "backup_count": 5,
    "format": "%(asctime)s - %(name)s - %(levelname)s - [%(node_id)s] - %(message)s",
    "console_output": true
  },
  "protobuf": {
    "enabled": true,
    "extended_format": true,
    "validation": {
      "enabled": true,
      "strict_mode": false
    }
  }
}